<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SEU Numerical Methods – Summer 2025 – Assignments</title>
  <meta name="description" content="Cards grid of student assignment projects for SEU Numerical Methods (Summer 2025).">
  <link rel="icon" href="data:,">
  <style>
    :root{
      --maxw:1200px; --gap:1rem; --radius:16px; --shadow:0 6px 18px rgba(0,0,0,.06);
      /* Light theme to match main site */
      --bg:#ffffff; --card:#ffffff; --muted:#6b7280; --text:#111827; --accent:#2563eb; --border:#e5e7eb;
    }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    header{max-width:var(--maxw);margin:2.5rem auto 1rem;padding:0 1rem}
    h1{margin:0 0 .25rem;font-size:clamp(1.4rem,2.5vw,2rem);letter-spacing:.2px}
    .sub{color:var(--muted);font-size:.95rem}

    .controls{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}
    .search{flex:1 1 260px}
    input[type="search"],select{background:#fff;color:var(--text);border:1px solid var(--border);border-radius:12px;padding:.7rem .9rem;width:100%;outline:none}
    select{cursor:pointer}

    main{max-width:var(--maxw);margin:1rem auto 4rem;padding:0 1rem}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:var(--gap)}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);display:flex;flex-direction:column;min-height:180px;transition:transform .12s ease, box-shadow .12s ease}
    .card:hover{transform:translateY(-2px);box-shadow:0 12px 24px rgba(0,0,0,.08)}
    .card .head{padding:1rem 1rem .5rem;border-bottom:1px solid var(--border)}
    .card .title{margin:0;font-size:1.05rem;line-height:1.3;word-break:break-word}
    .path{color:var(--muted);font-size:.82rem;margin-top:.35rem;word-break:break-all}
    .card .body{padding:1rem;display:flex;flex-direction:column;gap:.75rem}
    .pill{display:inline-flex;align-items:center;gap:.4rem;background:#f3f4f6;border:1px solid var(--border);border-radius:999px;padding:.25rem .6rem;font-size:.78rem;color:#374151}
    .contributors{display:flex;flex-wrap:wrap;gap:.4rem}
    .contrib{display:flex;align-items:center;gap:.4rem;background:#f3f4f6;border:1px solid var(--border);padding:.25rem .5rem;border-radius:999px;font-size:.78rem;text-decoration:none;color:inherit}
    .contrib img{width:18px;height:18px;border-radius:50%}
    .foot{margin-top:auto;display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;border-top:1px solid var(--border)}
    .btn{appearance:none;border:1px solid var(--border);background:#f8fafc;color:var(--text);padding:.5rem .75rem;border-radius:10px;font-size:.85rem;text-decoration:none;display:inline-flex;align-items:center;gap:.5rem}
    .btn:hover{background:#eef2f7}
    .muted{color:var(--muted);font-size:.9rem}
    .hidden{display:none!important}
    footer{max-width:var(--maxw);margin:0 auto 3rem;padding:0 1rem;color:var(--muted);font-size:.9rem}
    .spinner{width:20px;height:20px;border-radius:50%;border:3px solid var(--border);border-top-color:var(--accent);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <header>
    <h1>SEU Numerical Methods – Summer 2025</h1>
    <div class="sub">Assignment Library • Built from <code>projects.json</code></div>
    <div class="controls">
      <div class="search"><input id="q" type="search" placeholder="Search by project name, repo path, or contributor…" aria-label="Search" /></div>
      <select id="sort" aria-label="Sort projects">
        <option value="name">Sort: Name (A→Z)</option>
        <option value="recent">Sort: Recently Updated</option>
      </select>
    </div>
  </header>

  <main>
    <div id="status" class="muted" style="display:flex;align-items:center;gap:.6rem">
      <div class="spinner"></div><span>Loading projects…</span>
    </div>
    <section class="grid" id="grid"></section>
  </main>

  <footer>
    <p>Source: <a href="./projects.json">projects.json</a> • <a href="https://tashreefmuhammad.github.io/">Main site</a></p>
  </footer>

<script>
(function () {
  const grid   = document.getElementById('grid');
  const status = document.getElementById('status');
  const q      = document.getElementById('q');
  const sortEl = document.getElementById('sort');

  // Small DOM helper
  function el(tag, attrs = {}, ...kids){
    const e = document.createElement(tag);
    for (const [k,v] of Object.entries(attrs)) {
      if (k === 'class') e.className = v;
      else if (k === 'html') e.innerHTML = v;
      else if (k === 'ariaLabel') e.setAttribute('aria-label', v);
      else e.setAttribute(k, v);
    }
    for (const k of kids.flat()) {
      if (k == null) continue;
      e.appendChild(typeof k === 'string' ? document.createTextNode(k) : k);
    }
    return e;
  }

  function render(list){
    grid.innerHTML = '';
    if (!list.length) {
      grid.appendChild(el('div', {class: 'muted'}, 'No projects found.'));
      return;
    }

    list.forEach(item => {
      const displayTitle = item.title || item.name || item.path || 'Untitled Project';
      const title = el('h3', {class:'title'}, displayTitle);
      const path  = el('div', {class:'path'}, item.path || '');
      const head  = el('div', {class:'head'}, title, path);

      const contribWrap = el('div', {class:'contributors'});
      if (Array.isArray(item.contributors) && item.contributors.length) {
        item.contributors.forEach(c => {
          contribWrap.appendChild(
            el('a', {class:'contrib', href:c.html_url, target:'_blank', rel:'noopener'},
              el('img', {src:c.avatar_url, alt:''}),
              el('span', {}, c.login)
            )
          );
        });
      } else {
        contribWrap.appendChild(el('span', {class:'muted'}, 'No contributors listed'));
      }

      const body  = el('div', {class:'body'},
        el('div', {class:'pill'}, `Last update: ${item.updatedAt ? new Date(item.updatedAt).toLocaleString() : '—'}`),
        item.description ? el('div', {class:'muted'}, item.description) : null,
        contribWrap
      );

      const open  = el('a', {class:'btn', href:item.url, target:'_blank', rel:'noopener'}, 'Open Project');
      const foot  = el('div', {class:'foot'}, open, el('span', {class:'muted'}, ''));

      grid.appendChild(el('article', {class:'card'}, head, body, foot));
    });
  }

  function filterAndSort(items){
    const query = (q.value || '').trim().toLowerCase();
    const mode  = sortEl.value;

    let list = items.slice();
    if (query) {
      list = list.filter(it => {
        const text = [
          it.title || '', it.name || '', it.path || '', it.description || '',
          ...(it.contributors || []).map(c => c.login || '')
        ].join(' ').toLowerCase();
        return text.includes(query);
      });
    }
    if (mode === 'name') {
      list.sort((a,b) => (a.title || a.name || a.path || '').localeCompare(b.title || b.name || b.path || ''));
    } else {
      list.sort((a,b) => new Date(b.updatedAt || 0) - new Date(a.updatedAt || 0));
    }
    render(list);
  }

  // Load data (projects + overrides) and render
  Promise.all([
    fetch('./projects.json',  {cache:'no-store'}).then(r => { if(!r.ok) throw new Error(r.status+' '+r.statusText); return r.json(); }),
    fetch('./overrides.json', {cache:'no-store'}).then(r => r.ok ? r.json() : {})
  ])
  .then(([items, overrides]) => {
    // Merge overrides by exact path (preferred) or by name as fallback
    items.forEach(it => {
      const ov = overrides[it.path] || overrides[it.name];
      if (!ov) return;
      if (ov.title) it.title = ov.title;
      if (ov.description) it.description = ov.description;
      // keep it minimal—no group badge logic since titles already include text like "[Group α]"
    });

    status.style.display = 'none';
    render(items);

    q.addEventListener('input', () => filterAndSort(items));
    sortEl.addEventListener('change', () => filterAndSort(items));
  })
  .catch(err => {
    status.textContent = '⚠️ Failed to load data: ' + err.message;
  });
})();
</script>

</body>
</html>
